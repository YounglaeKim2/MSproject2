<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NewCompatibility API í…ŒìŠ¤íŠ¸</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #333;
        text-align: center;
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background: #f9f9f9;
      }
      button {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #0056b3;
      }
      .result {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 5px;
        padding: 15px;
        margin-top: 10px;
        white-space: pre-wrap;
        max-height: 400px;
        overflow-y: auto;
      }
      .success {
        border-color: #28a745;
        background: #d4edda;
      }
      .error {
        border-color: #dc3545;
        background: #f8d7da;
      }
      .form-row {
        display: flex;
        gap: 10px;
        margin: 10px 0;
        align-items: center;
      }
      .form-row label {
        min-width: 80px;
        font-weight: bold;
      }
      .form-row input,
      .form-row select {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        flex: 1;
      }
      .person-form {
        border: 2px solid #e9ecef;
        padding: 15px;
        margin: 10px 0;
        border-radius: 8px;
      }
      .person-form h4 {
        margin-top: 0;
        color: #495057;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¯ NewCompatibility API í…ŒìŠ¤íŠ¸</h1>

      <!-- 1. í—¬ìŠ¤ ì²´í¬ -->
      <div class="test-section">
        <h3>1. í—¬ìŠ¤ ì²´í¬ (SAJU API ì—°ê²° ìƒíƒœ)</h3>
        <button onclick="testHealth()">í—¬ìŠ¤ ì²´í¬ ì‹¤í–‰</button>
        <div id="health-result" class="result" style="display: none"></div>
      </div>

      <!-- 2. ì„œë¹„ìŠ¤ ì •ë³´ -->
      <div class="test-section">
        <h3>2. ì„œë¹„ìŠ¤ ì •ë³´ ì¡°íšŒ</h3>
        <button onclick="testServiceInfo()">ì„œë¹„ìŠ¤ ì •ë³´ ì¡°íšŒ</button>
        <div id="info-result" class="result" style="display: none"></div>
      </div>

      <!-- 3. SAJU API ì—°ê²° í…ŒìŠ¤íŠ¸ -->
      <div class="test-section">
        <h3>3. SAJU API ì—°ê²° í…ŒìŠ¤íŠ¸</h3>
        <p>ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ SAJU API ì—°ê²°ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
        <button onclick="testSajuConnection()">SAJU ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        <div id="connection-result" class="result" style="display: none"></div>
      </div>

      <!-- 4. ì‹¤ì œ ê¶í•© ë¶„ì„ (ê¸°ë³¸ ë°ì´í„°) -->
      <div class="test-section">
        <h3>4. ì‹¤ì œ ê¶í•© ë¶„ì„ (ê¸°ë³¸ ë°ì´í„°)</h3>
        <p>
          ê¹€ë¯¼ìˆ˜(1990.5.15 14ì‹œ)ì™€ ì´ì§€ì€(1992.8.20 10ì‹œ)ì˜ ê¶í•©ì„ ë¶„ì„í•©ë‹ˆë‹¤.
        </p>
        <button onclick="testCompatibilityAnalysis()">ê¶í•© ë¶„ì„ ì‹¤í–‰</button>
        <div id="analysis-result" class="result" style="display: none"></div>
      </div>

      <!-- 5. ì»¤ìŠ¤í…€ ê¶í•© ë¶„ì„ -->
      <div class="test-section">
        <h3>5. ì»¤ìŠ¤í…€ ê¶í•© ë¶„ì„</h3>
        <div class="person-form">
          <h4>ğŸ‘¤ ì²« ë²ˆì§¸ ì‚¬ëŒ</h4>
          <div class="form-row">
            <label>ì´ë¦„:</label>
            <input type="text" id="person1-name" value="í™ê¸¸ë™" />
          </div>
          <div class="form-row">
            <label>ìƒë…„ì›”ì¼:</label>
            <input
              type="number"
              id="person1-year"
              value="1985"
              min="1900"
              max="2030"
              placeholder="ë…„"
            />
            <input
              type="number"
              id="person1-month"
              value="3"
              min="1"
              max="12"
              placeholder="ì›”"
            />
            <input
              type="number"
              id="person1-day"
              value="12"
              min="1"
              max="31"
              placeholder="ì¼"
            />
            <input
              type="number"
              id="person1-hour"
              value="15"
              min="0"
              max="23"
              placeholder="ì‹œ"
            />
          </div>
          <div class="form-row">
            <label>ì„±ë³„:</label>
            <select id="person1-gender">
              <option value="male">ë‚¨ì„±</option>
              <option value="female">ì—¬ì„±</option>
            </select>
          </div>
        </div>

        <div class="person-form">
          <h4>ğŸ‘¤ ë‘ ë²ˆì§¸ ì‚¬ëŒ</h4>
          <div class="form-row">
            <label>ì´ë¦„:</label>
            <input type="text" id="person2-name" value="ê¹€ì˜í¬" />
          </div>
          <div class="form-row">
            <label>ìƒë…„ì›”ì¼:</label>
            <input
              type="number"
              id="person2-year"
              value="1987"
              min="1900"
              max="2030"
              placeholder="ë…„"
            />
            <input
              type="number"
              id="person2-month"
              value="7"
              min="1"
              max="12"
              placeholder="ì›”"
            />
            <input
              type="number"
              id="person2-day"
              value="25"
              min="1"
              max="31"
              placeholder="ì¼"
            />
            <input
              type="number"
              id="person2-hour"
              value="11"
              min="0"
              max="23"
              placeholder="ì‹œ"
            />
          </div>
          <div class="form-row">
            <label>ì„±ë³„:</label>
            <select id="person2-gender">
              <option value="female">ì—¬ì„±</option>
              <option value="male">ë‚¨ì„±</option>
            </select>
          </div>
        </div>

        <button onclick="testCustomCompatibility()">
          ì»¤ìŠ¤í…€ ê¶í•© ë¶„ì„ ì‹¤í–‰
        </button>
        <div id="custom-result" class="result" style="display: none"></div>
      </div>
    </div>

    <script>
      const API_BASE = "http://localhost:8003";

      async function makeRequest(url, options = {}) {
        try {
          const response = await fetch(url, {
            headers: {
              "Content-Type": "application/json",
              ...options.headers,
            },
            ...options,
          });
          const data = await response.json();
          return { success: response.ok, data, status: response.status };
        } catch (error) {
          return { success: false, error: error.message };
        }
      }

      function showResult(elementId, result) {
        const element = document.getElementById(elementId);
        element.style.display = "block";
        element.className = "result " + (result.success ? "success" : "error");
        element.textContent = JSON.stringify(result, null, 2);
      }

      async function testHealth() {
        console.log("í—¬ìŠ¤ ì²´í¬ ì‹œì‘...");
        const result = await makeRequest(`${API_BASE}/health`);
        showResult("health-result", result);
      }

      async function testServiceInfo() {
        console.log("ì„œë¹„ìŠ¤ ì •ë³´ ì¡°íšŒ ì‹œì‘...");
        const result = await makeRequest(`${API_BASE}/info`);
        showResult("info-result", result);
      }

      async function testSajuConnection() {
        console.log("SAJU ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...");
        const testData = {
          person1: {
            year: 1990,
            month: 5,
            day: 15,
            hour: 14,
            gender: "male",
            name: "ê¹€ë¯¼ìˆ˜",
          },
          person2: {
            year: 1992,
            month: 8,
            day: 20,
            hour: 10,
            gender: "female",
            name: "ì´ì§€ì€",
          },
        };

        const result = await makeRequest(
          `${API_BASE}/api/v1/compatibility/test`,
          {
            method: "POST",
            body: JSON.stringify(testData),
          }
        );
        showResult("connection-result", result);
      }

      async function testCompatibilityAnalysis() {
        console.log("ê¶í•© ë¶„ì„ ì‹œì‘...");
        const testData = {
          person1: {
            year: 1990,
            month: 5,
            day: 15,
            hour: 14,
            gender: "male",
            name: "ê¹€ë¯¼ìˆ˜",
          },
          person2: {
            year: 1992,
            month: 8,
            day: 20,
            hour: 10,
            gender: "female",
            name: "ì´ì§€ì€",
          },
        };

        const result = await makeRequest(
          `${API_BASE}/api/v1/compatibility/analyze`,
          {
            method: "POST",
            body: JSON.stringify(testData),
          }
        );
        showResult("analysis-result", result);
      }

      async function testCustomCompatibility() {
        console.log("ì»¤ìŠ¤í…€ ê¶í•© ë¶„ì„ ì‹œì‘...");

        const customData = {
          person1: {
            year: parseInt(document.getElementById("person1-year").value),
            month: parseInt(document.getElementById("person1-month").value),
            day: parseInt(document.getElementById("person1-day").value),
            hour: parseInt(document.getElementById("person1-hour").value),
            gender: document.getElementById("person1-gender").value,
            name: document.getElementById("person1-name").value,
          },
          person2: {
            year: parseInt(document.getElementById("person2-year").value),
            month: parseInt(document.getElementById("person2-month").value),
            day: parseInt(document.getElementById("person2-day").value),
            hour: parseInt(document.getElementById("person2-hour").value),
            gender: document.getElementById("person2-gender").value,
            name: document.getElementById("person2-name").value,
          },
        };

        const result = await makeRequest(
          `${API_BASE}/api/v1/compatibility/analyze`,
          {
            method: "POST",
            body: JSON.stringify(customData),
          }
        );
        showResult("custom-result", result);
      }

      // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ìœ¼ë¡œ í—¬ìŠ¤ ì²´í¬ ì‹¤í–‰
      window.onload = function () {
        console.log("NewCompatibility API í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œë¨");
        setTimeout(testHealth, 1000);
      };
    </script>
  </body>
</html>
