# 개발자 가이드라인 📋

> **MSProject2 SAJU** 동료 개발자를 위한 필수 가이드  
> **작성일**: 2025-07-31  
> **목적**: 빠르고 안전한 개발 환경 구축

---

## 🚨 반드시 읽어주세요!

### ⚠️ 중요한 경고사항

1. **관상학 서비스는 절대 Docker 없이 실행하지 마세요!**

   ```bash
   # ❌ 절대 하지 마세요
   cd Physiognomy/backend && python main.py
   cd Physiognomy/frontend && npm start

   # ✅ 반드시 Docker로 실행하세요
   cd Physiognomy && docker-compose up
   ```

   - **이유**: MediaPipe, OpenCV 등 무거운 AI 라이브러리 설치 시 1시간+ 소요
   - **Docker 사용 시**: 2분 만에 완료 ⚡

2. **포트 충돌 주의**
   - 8개 포트가 동시에 사용됩니다: `4000, 3000, 3001, 3002, 8000, 8001, 8002, 8082`
   - 실행 전 포트 사용 여부를 확인하세요

---

## 🚀 빠른 시작 가이드

### 필수 요구사항

- **Python** 3.8+
- **Node.js** 14+
- **Docker Desktop** (관상학 서비스용 필수!)
- **Git**

### 1단계: 저장소 클론

```bash
git clone [repository-url]
cd MSproject2
```

### 2단계: 서비스별 실행

#### Option A: 전체 서비스 한 번에 (권장)

```bash
# Windows
./scripts/start_all.bat

# Linux (향후 지원 예정)
./scripts/start_all.sh
```

#### Option B: 서비스별 개별 실행

**🔥 실행 순서가 중요합니다!**

```bash
# 1. 랜딩 페이지 (포트 4000)
cd landing
python server.py

# 2. SAJU 백엔드 (포트 8000)
cd ../SAJU/backend
pip install -r requirements.txt
uvicorn app.main:app --reload --port 8000

# 3. SAJU 프론트엔드 (포트 3000)
cd ../frontend
npm install
npm start

# 4. 궁합 백엔드 (포트 8002)
cd ../../Compatibility/backend
pip install -r requirements.txt
uvicorn app.main:app --reload --port 8002

# 5. 궁합 프론트엔드 (포트 3002)
cd ../frontend
npm install
npm start

# 6. 🐳 관상학 서비스 (포트 8001/3001) - Docker 필수!
cd ../../Physiognomy
docker-compose up --build

# 7. 📱 모바일 앱 (포트 8082)
cd ../AppService/FortuneApp
npm install
npx expo start --port 8082
```

### 3단계: 접속 확인

모든 서비스가 정상 실행되면 다음 URL에서 확인:

| 서비스        | URL                        | 상태 확인        |
| ------------- | -------------------------- | ---------------- |
| **랜딩 허브** | http://localhost:4000      | 메인 페이지 로딩 |
| **사주 분석** | http://localhost:3000      | 사주 입력 폼     |
| **궁합 분석** | http://localhost:3002      | 궁합 입력 폼     |
| **관상 분석** | http://localhost:3001      | 이미지 업로드    |
| **모바일 앱** | http://localhost:8082      | Expo 개발 서버   |
| SAJU API      | http://localhost:8000/docs | Swagger 문서     |
| 궁합 API      | http://localhost:8002/docs | Swagger 문서     |
| 관상 API      | http://localhost:8001/docs | Swagger 문서     |

---

## 🛠️ 개발 환경별 가이드

### Windows 개발자

```bash
# PowerShell 또는 CMD 사용
# Git Bash 권장 (Unix 명령어 호환성)
```

### macOS/Linux 개발자

```bash
# 기본 터미널 사용 가능
# Docker Desktop 설치 필수
```

### VS Code 사용자

```bash
# 권장 확장프로그램
- Python
- TypeScript and JavaScript Language Features
- Docker
- Thunder Client (API 테스트용)
```

---

## ⚡ 개발 워크플로우

### 새로운 기능 개발 시

1. **브랜치 생성**

   ```bash
   git checkout -b feature/새기능명
   ```

2. **개발 환경 실행**

   ```bash
   # 해당 서비스만 실행 (예: SAJU 서비스)
   cd SAJU/backend && uvicorn app.main:app --reload --port 8000
   cd SAJU/frontend && npm start
   ```

3. **API 테스트**

   ```bash
   # 헬스 체크
   curl http://localhost:8000/health

   # API 문서 확인
   http://localhost:8000/docs
   ```

4. **코드 작성 및 테스트**
5. **커밋 및 푸시**

### 버그 수정 시

1. **문제 재현**
2. **관련 서비스만 실행**
3. **수정 및 테스트**
4. **전체 서비스 통합 테스트**

---

## 🚨 트러블슈팅

### 자주 발생하는 문제들

#### 1. 포트 이미 사용 중

```bash
# 문제: Port 3000 is already in use
# 해결: 사용 중인 프로세스 종료
# Windows
netstat -ano | findstr :3000
taskkill /PID [PID번호] /F

# macOS/Linux
lsof -ti:3000
kill -9 [PID번호]
```

#### 2. 관상학 서비스 프론트엔드 무한 로딩

```bash
# 문제: React 개발 서버가 1시간+ 로딩
# 원인: 무거운 AI 라이브러리들
# 해결: Docker 사용 강제!
cd Physiognomy && docker-compose up
```

#### 3. Python 패키지 설치 오류

```bash
# 가상환경 사용 권장
python -m venv venv
source venv/bin/activate  # macOS/Linux
venv\Scripts\activate     # Windows
pip install -r requirements.txt
```

#### 4. npm 설치 오류

```bash
# 캐시 삭제 후 재시도
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

#### 5. Docker 메모리 부족

```bash
# Docker Desktop 설정에서 메모리 할당량 증가
# 권장: 최소 4GB, 이상적으로 8GB
```

### 로그 확인 방법

```bash
# 각 서비스별 로그 위치
# SAJU 백엔드: 터미널 출력
# 관상학 서비스: docker-compose logs
docker-compose logs physiognomy-backend
docker-compose logs physiognomy-frontend
```

---

## 📊 성능 최적화 팁

### 개발 시 빠른 실행

```bash
# 필요한 서비스만 실행
# 예: SAJU 서비스만 개발할 때
cd SAJU/backend && uvicorn app.main:app --reload --port 8000
cd SAJU/frontend && npm start
```

### 메모리 사용량 최적화

- **관상학 서비스**: Docker로만 실행 (필수)
- **기타 서비스**: 개발 시에는 개별 실행 가능
- **전체 테스트**: 모든 서비스 동시 실행

### 빌드 시간 단축

```bash
# Docker 빌드 캐시 활용
docker-compose build --no-cache  # 처음에만
docker-compose up                # 이후에는 캐시 사용
```

---

## 🧪 테스트 가이드

### API 테스트

```bash
# 사주 분석 테스트
curl -X POST http://localhost:8000/api/v1/saju/analyze \
-H "Content-Type: application/json" \
-d '{"year":1990,"month":5,"day":15,"hour":14,"gender":"male","name":"홍길동"}'

# 궁합 분석 테스트
curl -X POST http://localhost:8002/api/v1/compatibility/analyze \
-H "Content-Type: application/json" \
-d '{"person1":{"year":1990,"month":5,"day":15,"hour":14,"gender":"male","name":"홍길동"},"person2":{"year":1992,"month":8,"day":22,"hour":10,"gender":"female","name":"김영희"}}'
```

### 프론트엔드 테스트

- 각 서비스 URL에 직접 접속
- 기본 기능 동작 확인
- 모바일 화면에서도 테스트

---

## 🔧 유용한 개발 도구

### API 테스트 도구

- **Thunder Client** (VS Code 확장)
- **Postman**
- **curl** (명령줄)

### 데이터베이스 도구

- **DB Browser for SQLite** (SAJU 서비스)
- **pgAdmin** (관상학 서비스)

### Docker 관리

- **Docker Desktop** (GUI)
- **Portainer** (웹 기반 관리)

---

## 📝 코딩 컨벤션

### Python (백엔드)

```python
# 함수명: snake_case
def analyze_saju_data():
    pass

# 클래스명: PascalCase
class SajuAnalyzer:
    pass

# 상수: UPPER_CASE
MAX_RETRY_COUNT = 3
```

### TypeScript (프론트엔드)

```typescript
// 컴포넌트명: PascalCase
const SajuAnalysisForm = () => {};

// 함수/변수명: camelCase
const handleSubmit = () => {};
const analysisResult = {};

// 인터페이스: PascalCase + I prefix
interface ISajuData {
  year: number;
  month: number;
}
```

---

## 🆘 도움이 필요할 때

### 1차 지원

1. **이 문서의 트러블슈팅 섹션** 확인
2. **API 문서** 참조 (http://localhost:8000/docs)
3. **로그 메시지** 확인

### 2차 지원

1. **GitHub Issues** 등록
2. **팀 채팅방**에서 문의
3. **코드 리뷰** 요청

### 긴급 상황

- **서비스 전체 중단**: 즉시 팀 리더에게 연락
- **데이터 손실 위험**: 백업 복구 절차 실행
- **보안 문제**: 즉시 서비스 중단 후 보고

---

## 🎯 마무리 체크리스트

개발 환경 설정 완료 후 확인사항:

- [ ] 8개 서비스 모두 정상 실행 확인
- [ ] 각 서비스 URL 접속 가능
- [ ] API 문서 페이지 로딩 확인
- [ ] 기본 기능 테스트 완료
- [ ] Docker Desktop 정상 작동
- [ ] Git 저장소 연결 확인

---

**🎉 축하합니다! 이제 MSProject2 SAJU 개발을 시작할 준비가 완료되었습니다!**

_궁금한 점이 있으면 언제든지 문의해 주세요. 함께 멋진 서비스를 만들어봅시다! 🚀_

---

_© 2025 MSProject2 SAJU Development Team_
