# 🚀 MSProject2 향후 개발 계획 - 추가 요구사항

> 2025-08-03 작성  
> Phase 4-5 및 추가 기능 개발 계획

## 🎯 기존 완료 상황

### ✅ **Phase 1-3 완료**
- **Phase 1**: API 연동 기반 구축 ✅
- **Phase 2**: 실제 사주분석 연동 ✅  
- **Phase 3**: 8개 확장운세 추가 ✅

### 📱 **완성된 서비스**
- **웹 서비스**: SAJU (localhost:3000)
- **모바일 앱**: AppService (iOS/Android)
- **백엔드 API**: SAJU API (localhost:8000)
- **랜딩 페이지**: Main App (localhost:4000)

---

## 🆕 새로운 추가 요구사항

### **요구사항 1: AI 기반 예상 질문 제안 시스템**

#### 📋 기능 설명
사주 분석 결과를 바탕으로 AI가 사용자가 궁금해할 만한 질문들을 자동으로 생성하여 제안하는 기능

#### 🎯 목적
- **사용자 참여도 향상**: 능동적인 질문 유도
- **서비스 체류 시간 증가**: 추가 상담 기회 제공
- **AI 활용도 극대화**: Gemini AI의 컨텍스트 기반 질문 생성

#### 💡 구현 아이디어
```typescript
// 예상 질문 생성 API
interface SuggestedQuestion {
  id: string;
  question: string;
  category: '연애' | '직업' | '건강' | '재물' | '가족';
  priority: 'high' | 'medium' | 'low';
  aiResponse?: string; // 미리 생성된 답변 (선택사항)
}

// 사주 분석 결과 기반 질문 생성
const generateSuggestedQuestions = async (sajuResult: SajuAnalysisResult) => {
  const prompt = `
  다음 사주 분석 결과를 바탕으로 사용자가 궁금해할 만한 질문 5개를 생성해주세요:
  
  사주팔자: ${sajuResult.palja}
  오행 분석: ${sajuResult.wuxing}
  성격 분석: ${sajuResult.basic_analysis.personality}
  
  각 질문은 구체적이고 개인화된 내용이어야 합니다.
  `;
  
  return await callGeminiAPI(prompt);
};
```

#### 🖼️ UI/UX 설계
```
[사주 분석 결과 표시]

💬 AI가 추천하는 질문들
┌─────────────────────────────────────┐
│ 🔮 "올해 하반기 연애운이 어떨까요?"    │
│ 💼 "현재 직장에서 승진 가능성은?"      │  
│ 💰 "투자하기 좋은 시기는 언제인가요?" │
│ 👨‍👩‍👧‍👦 "가족과의 관계 개선 방법은?"     │
│ 🏥 "건강 관리에서 주의할 점은?"       │
└─────────────────────────────────────┘
[질문 클릭 시 → AI 상담 화면으로 이동]
```

---

### **요구사항 2: 궁합운 점수 극단화 시스템**

#### 📋 기능 설명
현재 궁합 점수가 애매하게 나오는 문제를 해결하여, 명확하게 "좋음(70-100)" 또는 "나쁨(0-30)" 으로 극단화

#### 🎯 목적
- **명확한 판단 기준**: 애매한 점수 제거
- **시각적 임팩트**: 색상으로 즉시 인식 가능
- **사용자 만족도**: 확실한 결과로 신뢰성 향상

#### 💡 구현 아이디어
```python
# 기존 궁합 점수 계산 로직 수정
def calculate_extreme_compatibility_score(person1_saju, person2_saju):
    """극단화된 궁합 점수 계산"""
    
    # 기본 궁합 점수 계산
    base_score = calculate_basic_compatibility(person1_saju, person2_saju)
    
    # 극단화 로직 적용
    if base_score >= 60:
        # 좋은 궁합 → 70-100 범위로 재매핑
        extreme_score = 70 + (base_score - 60) * 30 / 40
        color = "blue"  # 파란색
        level = "excellent" if extreme_score >= 85 else "good"
    else:
        # 나쁜 궁합 → 0-30 범위로 재매핑  
        extreme_score = (base_score / 60) * 30
        color = "red"   # 빨간색
        level = "poor" if extreme_score <= 15 else "bad"
    
    return {
        "score": int(extreme_score),
        "color": color,
        "level": level,
        "message": generate_extreme_message(extreme_score, level)
    }

def generate_extreme_message(score, level):
    """극단적 메시지 생성"""
    if level == "excellent":
        return "💙 천생연분! 최고의 궁합입니다!"
    elif level == "good":
        return "💙 매우 좋은 궁합! 행복한 관계가 될 것입니다!"
    elif level == "bad":
        return "❤️ 조심스러운 관계! 많은 노력이 필요합니다!"
    else:  # poor
        return "❤️ 어려운 궁합! 신중한 판단이 필요합니다!"
```

#### 🎨 UI 디자인 변경
```typescript
// 프론트엔드 궁합 점수 표시
interface CompatibilityResult {
  score: number;        // 0-30 또는 70-100
  color: 'blue' | 'red';
  level: 'excellent' | 'good' | 'bad' | 'poor';
  message: string;
}

// 색상 매핑
const getScoreColor = (result: CompatibilityResult) => {
  return {
    blue: {
      background: '#E3F2FD',
      border: '#1976D2', 
      text: '#0D47A1'
    },
    red: {
      background: '#FFEBEE',
      border: '#D32F2F',
      text: '#B71C1C'  
    }
  }[result.color];
};
```

---

## 📋 구체적 개발 계획

### **Phase 4: AI 예상 질문 시스템 (2-3시간)**

#### 4.1 백엔드 구현
```python
# SAJU/backend/app/services/ai_question_generator.py
class AIQuestionGenerator:
    def __init__(self):
        self.gemini_client = GeminiClient()
    
    async def generate_questions(self, saju_result: dict) -> List[SuggestedQuestion]:
        """사주 결과 기반 질문 생성"""
        
    async def get_question_answer(self, question: str, saju_context: dict) -> str:
        """특정 질문에 대한 AI 답변 생성"""

# API 엔드포인트 추가
@router.post("/suggested-questions")
async def get_suggested_questions(birth_info: BirthInfo):
    """사주 분석 후 예상 질문 리스트 반환"""
```

#### 4.2 프론트엔드 구현
```typescript
// 웹/모바일 공통 컴포넌트
interface SuggestedQuestionsProps {
  sajuResult: SajuAnalysisResult;
  onQuestionSelect: (question: SuggestedQuestion) => void;
}

const SuggestedQuestions: React.FC<SuggestedQuestionsProps> = ({
  sajuResult,
  onQuestionSelect
}) => {
  // 질문 카드 리스트 렌더링
  // 카테고리별 색상 구분
  // 클릭 시 AI 채팅으로 이동
};
```

#### 4.3 통합 플로우
```
1. 사주 분석 완료
2. AI 질문 생성 API 호출  
3. 추천 질문 카드 표시
4. 질문 선택 시 AI 채팅 화면 이동
5. 선택된 질문 컨텍스트로 대화 시작
```

---

### **Phase 5: 궁합운 극단화 시스템 (1-2시간)**

#### 5.1 궁합 점수 로직 수정
```python
# SAJU/backend/app/services/compatibility_analyzer.py 수정

class ExtremCompatibilityAnalyzer:
    @staticmethod
    def calculate_extreme_score(base_score: float) -> dict:
        """점수 극단화 로직"""
        
        # 60점 기준으로 극단화
        if base_score >= 60:
            # 좋은 궁합: 70-100 구간으로 재매핑
            extreme_score = 70 + ((base_score - 60) / 40) * 30
            return {
                "score": int(extreme_score),
                "color": "blue",
                "grade": "A" if extreme_score >= 85 else "B"
            }
        else:
            # 나쁜 궁합: 0-30 구간으로 재매핑
            extreme_score = (base_score / 60) * 30
            return {
                "score": int(extreme_score), 
                "color": "red",
                "grade": "D" if extreme_score <= 15 else "C"
            }
```

#### 5.2 프론트엔드 UI 업데이트
```typescript
// 궁합 점수 컴포넌트 수정
const CompatibilityScore: React.FC<{result: CompatibilityResult}> = ({result}) => {
  const colors = {
    blue: { bg: '#E3F2FD', border: '#1976D2', text: '#0D47A1' },
    red: { bg: '#FFEBEE', border: '#D32F2F', text: '#B71C1C' }
  };
  
  return (
    <View style={[styles.scoreContainer, { 
      backgroundColor: colors[result.color].bg,
      borderColor: colors[result.color].border 
    }]}>
      <Text style={[styles.scoreText, { color: colors[result.color].text }]}>
        {result.score}점
      </Text>
      <Text style={styles.gradeText}>{result.grade}등급</Text>
      <Text style={styles.messageText}>{result.message}</Text>
    </View>
  );
};
```

---

## 🎯 개발 우선순위

### **High Priority (필수)**
1. **궁합 점수 극단화** - 사용자 만족도 직접 영향
2. **AI 예상 질문 시스템** - 서비스 차별화 요소

### **Medium Priority (권장)**  
3. **모바일 앱 동기화** - 웹과 동일한 기능 제공
4. **성능 최적화** - AI 호출 속도 향상

### **Low Priority (선택사항)**
5. **추가 UI/UX 개선** - 애니메이션, 트랜지션
6. **데이터 분석** - 사용자 행동 패턴 수집

---

## 📊 예상 개발 시간

| 기능 | 백엔드 | 프론트엔드 | 테스트 | 총 시간 |
|------|--------|------------|--------|---------|
| AI 예상 질문 | 1.5시간 | 1시간 | 0.5시간 | 3시간 |
| 궁합 극단화 | 0.5시간 | 1시간 | 0.5시간 | 2시간 |
| **총계** | **2시간** | **2시간** | **1시간** | **5시간** |

---

## 🧪 테스트 계획

### **AI 예상 질문 테스트**
```
1. 다양한 사주 결과로 질문 생성 테스트
2. 질문 품질 및 개인화 수준 검증  
3. AI 응답 속도 및 정확성 확인
4. 카테고리별 질문 분포 균형 검사
```

### **궁합 점수 극단화 테스트**
```
1. 기존 중간 점수들의 극단화 결과 확인
2. 색상 및 등급 표시 정확성 검증
3. 메시지 내용의 적절성 검사  
4. 다양한 궁합 케이스 시나리오 테스트
```

---

## 🎊 최종 완성 예상 결과

### **사용자 경험 개선**
- **명확한 판단**: 애매한 궁합 점수 제거 → 확실한 결과
- **능동적 참여**: AI 추천 질문으로 추가 상담 유도
- **시각적 임팩트**: 색상으로 즉시 인식 가능한 결과

### **서비스 차별화**
- **AI 기반 개인화**: 사주 결과 맞춤 질문 생성
- **감정적 연결**: 극단적 점수로 강한 인상 제공
- **사용자 체류**: 추가 질문으로 서비스 이용 시간 증가

### **비즈니스 가치**
- **재방문율 향상**: 새로운 질문으로 재사용 유도
- **만족도 증가**: 명확한 결과로 신뢰성 향상  
- **입소문 효과**: 강렬한 결과로 공유 의욕 증대

---

## 📝 구현 체크리스트

### **AI 예상 질문 시스템**
- [ ] Gemini API 질문 생성 프롬프트 설계
- [ ] 백엔드 질문 생성 서비스 구현
- [ ] 프론트엔드 질문 카드 컴포넌트  
- [ ] AI 채팅 연동 플로우
- [ ] 질문 카테고리별 색상 구분
- [ ] 모바일 앱 동기화

### **궁합 점수 극단화**
- [ ] 점수 극단화 알고리즘 구현
- [ ] 색상 및 등급 시스템 설계
- [ ] 극단적 메시지 생성 로직
- [ ] 프론트엔드 스타일링 업데이트
- [ ] 기존 궁합 분석과 통합
- [ ] 테스트 케이스 작성

---

**이제 이 계획에 따라 단계적으로 개발하면 더욱 완성도 높은 사주 분석 서비스가 될 것입니다!** 🚀

**어떤 기능부터 시작하시겠습니까?**