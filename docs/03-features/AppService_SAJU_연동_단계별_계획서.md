# 📱 AppService-SAJU 연동 단계별 계획서

> 2025-08-03 작성  
> React Native 모바일 앱과 SAJU 백엔드 API 완전 통합 로드맵

## 🎯 프로젝트 개요

**목표**: AppService (React Native 모바일 앱)을 SAJU 백엔드 API와 연동하여 완전한 모바일 사주 분석 서비스 구축

### 현재 상태
- **AppService**: React Native + Expo, 3개 화면, 정적 더미 데이터
- **SAJU Backend**: FastAPI, Phase 1+2 확장운세 (8개), Gemini AI 연동
- **연동 가능성**: ✅ 100% 호환

---

## 📋 단계별 구현 계획

### **Phase 1: 기본 API 연동 (1-2시간)**
🎯 **목표**: SAJU API 클라이언트 구축 및 기본 연결 테스트

#### 1.1 API 서비스 모듈 생성
- **파일**: `AppService/FortuneApp/src/services/sajuApi.ts`
- **기능**: 
  - SAJU API 엔드포인트 정의
  - fetch 기반 HTTP 클라이언트
  - 에러 핸들링 및 타입 정의

#### 1.2 API 연결 테스트
- **대상**: `/health`, `/test` 엔드포인트
- **확인**: CORS 설정, 네트워크 연결
- **결과**: 모바일 앱에서 백엔드 API 호출 성공

#### 1.3 타입 정의 추가
- **파일**: `AppService/FortuneApp/src/types/saju.ts`
- **내용**: API 요청/응답 인터페이스 정의

---

### **Phase 2: ProfileScreen 실제 사주분석 연동 (2-3시간)**
🎯 **목표**: 오행 분석 화면을 실제 SAJU API 분석 결과로 교체

#### 2.1 입력 데이터 매핑
- **기존**: 문자열 형태 생년월일/시간
- **변환**: SAJU API 형식 (year, month, day, hour, gender)
- **검증**: 입력값 유효성 검사 강화

#### 2.2 API 호출 로직 구현
- **엔드포인트**: `POST /api/v1/saju/analyze`
- **처리**: 로딩 상태, 에러 처리, 재시도 로직
- **저장**: AsyncStorage를 통한 결과 캐싱

#### 2.3 UI 결과 화면 업데이트
- **기존**: 하드코딩된 오행 분석 결과
- **신규**: 실제 API 응답 데이터 렌더링
  - 사주팔자 (천간/지지)
  - 오행 분석 (강약 분석)
  - 십성 분석
  - 기본 성격/건강/재물운

---

### **Phase 3: HomeScreen 확장운세 추가 (2-3시간)**
🎯 **목표**: 홈 화면에 Phase 1+2 확장운세 (8개) 표시

#### 3.1 홈 화면 레이아웃 확장
- **추가 카드**: 연애운, 직업운, 건강운, 학업운 등
- **스크롤뷰**: 세로 스크롤 가능한 카드 리스트
- **색상**: Phase별 구분 색상 적용

#### 3.2 확장운세 API 연동
- **Phase 1**: `/extended-fortune` (연애운, 성격운, 인간관계운, 재물운)
- **Phase 2**: `/extended-fortune-phase2` (직업운, 건강운, 학업운, 가족운)
- **통합**: 8개 운세 동시 표시

#### 3.3 상세 화면 구현
- **네비게이션**: 각 운세 카드 터치 시 상세 화면
- **UI**: 운세별 맞춤 아이콘, 색상, 레이아웃
- **데이터**: 세부 분석 결과 표시

---

### **Phase 4: AI 채팅 기능 고도화 (1-2시간)**
🎯 **목표**: 외부 ChatGPT 대신 내장 Gemini AI 활용

#### 4.1 AI 채팅 API 연동
- **기존**: WebView로 외부 ChatGPT 연결
- **신규**: SAJU 백엔드의 Gemini AI 활용
- **엔드포인트**: `/ai-chat` (새로 구현 필요)

#### 4.2 채팅 UI 구현
- **화면**: 메시지 주고받기 인터페이스
- **기능**: 사주 분석 기반 맞춤 상담
- **컨텍스트**: 이전 분석 결과 기반 대화

---

### **Phase 5: 고급 기능 및 최적화 (2-3시간)**
🎯 **목표**: 사용자 경험 향상 및 앱 완성도 제고

#### 5.1 데이터 캐싱 시스템
- **AsyncStorage**: 분석 결과 로컬 저장
- **오프라인**: 네트워크 없이도 이전 결과 확인
- **업데이트**: 데이터 만료 및 갱신 로직

#### 5.2 사용자 프로필 관리
- **다중 프로필**: 가족 구성원별 사주 관리
- **즐겨찾기**: 자주 보는 운세 설정
- **히스토리**: 분석 기록 관리

#### 5.3 푸시 알림 (선택사항)
- **일일 운세**: 매일 아침 오늘의 운세 알림
- **특별 운세**: 중요 절기/명절 맞춤 운세

---

## 🛠 기술적 요구사항

### 개발 환경
- **Node.js**: 18+ (Expo 호환)
- **React Native**: 0.79.5
- **Expo SDK**: ~53.0.17
- **TypeScript**: ~5.8.3

### API 연동
- **Base URL**: `http://localhost:8000` (개발)
- **CORS**: React Native는 CORS 영향 없음
- **네트워크**: fetch API 사용

### 상태 관리
- **Local State**: useState, useEffect
- **Global State**: Context API (선택사항)
- **Storage**: AsyncStorage for 캐싱

---

## 📊 예상 작업 시간

| Phase | 작업 내용 | 예상 시간 | 우선순위 |
|-------|-----------|-----------|----------|
| 1 | API 연동 기반 구축 | 1-2시간 | 🔴 High |
| 2 | ProfileScreen 실제 분석 | 2-3시간 | 🔴 High |
| 3 | HomeScreen 확장운세 | 2-3시간 | 🟡 Medium |
| 4 | AI 채팅 고도화 | 1-2시간 | 🟡 Medium |
| 5 | 고급 기능 구현 | 2-3시간 | 🟢 Low |
| **총 예상 시간** | **8-13시간** | **2-3일** | - |

---

## 🚀 구현 순서 (권장)

### **1단계**: API 연동 기반 (필수)
```bash
cd AppService/FortuneApp
npm install
# API 서비스 모듈 생성 및 테스트
```

### **2단계**: 핵심 기능 (필수)
- ProfileScreen 실제 분석 연동
- 기본적인 사주 분석 결과 표시

### **3단계**: 확장 기능 (권장)
- HomeScreen 확장운세 추가
- 8개 운세 카드 UI 구현

### **4단계**: 고도화 (선택)
- AI 채팅, 캐싱, 프로필 관리

---

## ✅ 완료 기준

### Phase 1 완료
- [ ] API 서비스 모듈 구현
- [ ] `/health` 엔드포인트 연결 성공
- [ ] 타입 정의 완료

### Phase 2 완료
- [ ] ProfileScreen에서 실제 사주분석 결과 표시
- [ ] 오행 분석 실제 데이터 렌더링
- [ ] 에러 처리 및 로딩 상태 구현

### Phase 3 완료
- [ ] HomeScreen에 8개 확장운세 카드 표시
- [ ] Phase 1+2 API 연동 완료
- [ ] 운세별 상세 화면 구현

### 최종 완료
- [ ] 모바일 앱에서 완전한 사주 분석 서비스 제공
- [ ] 웹(SAJU)과 동일한 분석 결과 표시
- [ ] 안정적인 API 연동 및 에러 처리

---

## 📱 최종 결과물

**완전한 크로스플랫폼 사주 분석 서비스**
- **웹**: SAJU 서비스 (localhost:3000)
- **모바일**: AppService (iOS/Android)
- **공통 백엔드**: SAJU API (localhost:8000)

### 사용자 혜택
1. **언제 어디서나**: 모바일에서 즉시 사주 분석
2. **동일한 품질**: 웹과 같은 고품질 분석 결과
3. **확장된 운세**: Phase 1+2 총 8개 확장운세
4. **AI 상담**: Gemini 기반 맞춤 운세 해석

---

**📋 다음 단계**: Phase 1부터 단계별로 구현 시작

> 각 Phase 완료 후 테스트 및 검증을 거쳐 다음 단계로 진행