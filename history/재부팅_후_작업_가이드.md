# 재부팅 후 작업 가이드

📅 **작성일**: 2025년 7월 29일  
🎯 **상황**: 백엔드 리팩토링 완료 후 서버 재시작 필요

---

## 🚀 재부팅 후 즉시 실행할 명령어

### **1단계: 백엔드 서버 시작 (필수)**
```bash
cd SAJU/backend
uvicorn app.main:app --reload --port 8000
```
- **예상 시간**: 3-5초
- **확인 방법**: `http://localhost:8000/health` 접속 후 `{"status":"healthy"}` 확인

### **2단계: 프론트엔드 시작**

#### **Option A: 빠른 시작 (권장)**
```bash
cd SAJU/frontend
npm run start:fast
```
- **예상 시간**: 3초 ⚡
- **특징**: Production 빌드 기반, 즉시 실행

#### **Option B: 개발 모드 (Hot Reload 필요시)**
```bash
cd SAJU/frontend
npm start
```
- **예상 시간**: 1분 30초
- **특징**: Hot Reload 지원, 코드 수정 시 자동 새로고침

---

## 🧪 테스트 시나리오

### **기본 사주 분석 테스트**
1. **브라우저 접속**: http://localhost:3000
2. **테스트 데이터 입력**:
   - 년도: 1993
   - 월: 5
   - 일: 27
   - 시간: 15
   - 성별: 남성
   - 이름: 김영래
3. **"사주 분석하기"** 버튼 클릭
4. **예상 결과**: 정상적인 사주 분석 결과 표시

### **AI 채팅 기능 테스트**
1. 사주 분석 완료 후
2. **"🤖 AI와 상세 해석 나누기"** 버튼 클릭
3. **예상 결과**: AI 채팅 모달창 열림
4. **퀵 버튼 테스트**: "내 성격의 장단점을 알려주세요" 클릭
5. **예상 결과**: Google Gemini AI 응답 수신

---

## 🔧 완료된 리팩토링 내용

### **백엔드 개선사항**
- ✅ **새로운 API 구조**: `app/api/saju.py` 완전 재작성
- ✅ **안전한 데이터 변환**: `safe_convert_to_dict()` 함수 추가
- ✅ **강화된 에러 핸들링**: 글로벌 예외 처리기 추가
- ✅ **상세한 로깅**: 단계별 실행 과정 추적 가능
- ✅ **입력 검증**: `_validate_birth_info()` 함수
- ✅ **프론트엔드 호환**: `_format_for_frontend()` 함수

### **주요 변경 파일**
- `SAJU/backend/app/api/saju.py` - 완전 새로 작성
- `SAJU/backend/app/main.py` - 글로벌 에러 핸들러 추가
- `SAJU/backend/app/api/saju_old.py` - 기존 파일 백업

---

## ❗ 문제 해결 가이드

### **만약 여전히 500 에러가 발생한다면**

#### **1. 백엔드 로그 확인**
- 백엔드 터미널에서 상세한 에러 메시지 확인
- `=== 글로벌 에러 핸들러 ===` 로그 찾기

#### **2. API 직접 테스트**
```bash
curl -X POST "http://localhost:8000/api/v1/saju/analyze" \
  -H "Content-Type: application/json" \
  -d '{"year":1993,"month":5,"day":27,"hour":15,"gender":"male","name":"테스트"}'
```

#### **3. 개별 컴포넌트 테스트**
```bash
# 헬스 체크
curl http://localhost:8000/health

# AI 연결 테스트
curl http://localhost:8000/api/v1/saju/ai-test

# 사주 분석기 직접 테스트
cd SAJU/backend
python -c "from app.services.saju_analyzer import saju_analyzer; from app.models.saju import BirthInfoRequest; print('OK' if saju_analyzer.analyze_saju(BirthInfoRequest(year=1993, month=5, day=27, hour=15, gender='male', name='test')) else 'FAIL')"
```

---

## 🎯 성공 시 다음 단계

### **AI 채팅 기능이 정상 작동하면**
1. ✅ **기본 사주 분석** 완료
2. ✅ **AI 대화형 해석** 완료
3. ✅ **프론트엔드 최적화** 완료

### **다음 개발 우선순위**
1. **궁합 분석 서비스** 구현
2. **대운/세운 분석** UI 개선
3. **Physiognomy 서비스** AI 모델 통합
4. **성능 최적화** 및 안정성 강화

---

## 📊 현재 프로젝트 상태

### **완성도**
- **SAJU 기본 기능**: 100% ✅
- **AI 채팅 기능**: 95% (테스트 대기) ⏳
- **프론트엔드**: 100% ✅
- **백엔드 리팩토링**: 100% ✅

### **서비스 URL**
- **메인 페이지**: http://localhost:4000 (선택사항)
- **SAJU 서비스**: http://localhost:3000 ⭐ **메인**
- **API 문서**: http://localhost:8000/docs
- **API 헬스**: http://localhost:8000/health

---

## 💡 추가 팁

### **개발 효율성**
- **빠른 시작**: `npm run start:fast` 사용으로 3초 시작
- **Hot Reload**: 코드 수정이 필요할 때만 `npm start` 사용
- **로그 모니터링**: 백엔드 터미널을 항상 확인

### **디버깅**
- **브라우저 개발자 도구**: F12 → Console 탭
- **네트워크 탭**: API 요청/응답 상세 확인
- **백엔드 로그**: 실시간 에러 추적

---

## 🎊 기대 결과

**재부팅 후 정상 실행되면**:
- 🚀 **3초만에 서비스 시작** (빠른 모드)
- 🤖 **AI 채팅 완벽 작동** (Google Gemini 연동)
- 📊 **안정적인 사주 분석** (리팩토링된 백엔드)
- 🎨 **현대적인 UI/UX** (React + TypeScript)

**MSProject2 SAJU 서비스가 완전체로 거듭날 준비 완료!** ✨